<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 A tool to identify probable false positive detections | Motus R Book</title>
  <meta name="description" content="9 A tool to identify probable false positive detections | Motus R Book" />
  <meta name="generator" content="bookdown 0.20.3 and GitBook 2.6.7" />

  <meta property="og:title" content="9 A tool to identify probable false positive detections | Motus R Book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="BSC_Motus_Logo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 A tool to identify probable false positive detections | Motus R Book" />
  
  
  <meta name="twitter:image" content="BSC_Motus_Logo.png" />

<meta name="author" content="Tara L. Crewe, Zoe Crysler, and Philip Taylor" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advancedModelling.html"/>
<link rel="next" href="appendixA.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-12387576-13', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="https://beta.motus.org/MotusRBook">R for Motus</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>A walk through the use of R for Motus automated radio-telemetry data</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#whatBookCovers"><i class="fa fa-check"></i><b>1.1</b> What this book does not cover</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#sampleData"><i class="fa fa-check"></i><b>1.3</b> Sample datasets</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="loadingPackages.html"><a href="loadingPackages.html"><i class="fa fa-check"></i><b>2</b> Loading R Packages</a><ul>
<li class="chapter" data-level="2.1" data-path="loadingPackages.html"><a href="loadingPackages.html#installing-motus-packages"><i class="fa fa-check"></i><b>2.1</b> Installing Motus packages</a><ul>
<li class="chapter" data-level="2.1.1" data-path="loadingPackages.html"><a href="loadingPackages.html#troubleshooting-the-installation"><i class="fa fa-check"></i><b>2.1.1</b> Troubleshooting the installation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="loadingPackages.html"><a href="loadingPackages.html#installing-other-packages"><i class="fa fa-check"></i><b>2.2</b> Installing other packages</a></li>
<li class="chapter" data-level="2.3" data-path="loadingPackages.html"><a href="loadingPackages.html#internalProcessing"><i class="fa fa-check"></i><b>2.3</b> Internal data processing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="accessingData.html"><a href="accessingData.html"><i class="fa fa-check"></i><b>3</b> Accessing and understanding detections data</a><ul>
<li class="chapter" data-level="3.1" data-path="accessingData.html"><a href="accessingData.html#databaseStructure"><i class="fa fa-check"></i><b>3.1</b> Data structure</a></li>
<li class="chapter" data-level="3.2" data-path="accessingData.html"><a href="accessingData.html#databaseTypes"><i class="fa fa-check"></i><b>3.2</b> Database types</a></li>
<li class="chapter" data-level="3.3" data-path="accessingData.html"><a href="accessingData.html#loadPackages"><i class="fa fa-check"></i><b>3.3</b> Load relevant R packages</a></li>
<li class="chapter" data-level="3.4" data-path="accessingData.html"><a href="accessingData.html#set-system-environment"><i class="fa fa-check"></i><b>3.4</b> Set system environment</a></li>
<li class="chapter" data-level="3.5" data-path="accessingData.html"><a href="accessingData.html#importDetections"><i class="fa fa-check"></i><b>3.5</b> Downloading tag detections</a><ul>
<li class="chapter" data-level="3.5.1" data-path="accessingData.html"><a href="accessingData.html#downloadData"><i class="fa fa-check"></i><b>3.5.1</b> Download data for a project for the <em>first time</em></a></li>
<li class="chapter" data-level="3.5.2" data-path="accessingData.html"><a href="accessingData.html#userAuthentication"><i class="fa fa-check"></i><b>3.5.2</b> User Authentication</a></li>
<li class="chapter" data-level="3.5.3" data-path="accessingData.html"><a href="accessingData.html#download-data-for-a-receiver-for-the-first-time"><i class="fa fa-check"></i><b>3.5.3</b> Download data for a receiver for the <em>first time</em></a></li>
<li class="chapter" data-level="3.5.4" data-path="accessingData.html"><a href="accessingData.html#downloading-multiple-receivers-at-the-same-time"><i class="fa fa-check"></i><b>3.5.4</b> Downloading multiple receivers at the same time</a></li>
<li class="chapter" data-level="3.5.5" data-path="accessingData.html"><a href="accessingData.html#updating-all-.motus-files-within-a-directory"><i class="fa fa-check"></i><b>3.5.5</b> Updating all .motus files within a directory</a></li>
<li class="chapter" data-level="3.5.6" data-path="accessingData.html"><a href="accessingData.html#accessSQL"><i class="fa fa-check"></i><b>3.5.6</b> Accessing downloaded detection data</a></li>
<li class="chapter" data-level="3.5.7" data-path="accessingData.html"><a href="accessingData.html#addGPS"><i class="fa fa-check"></i><b>3.5.7</b> Adding GPS Data</a></li>
<li class="chapter" data-level="3.5.8" data-path="accessingData.html"><a href="accessingData.html#convertToFlat"><i class="fa fa-check"></i><b>3.5.8</b> Converting to flat file</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="accessingData.html"><a href="accessingData.html#exportDetections"><i class="fa fa-check"></i><b>3.6</b> Export your ‘flat’ dataframe to CSV or RDS file</a></li>
<li class="chapter" data-level="3.7" data-path="accessingData.html"><a href="accessingData.html#tagmeUpdate"><i class="fa fa-check"></i><b>3.7</b> Update and/or open an existing database</a></li>
<li class="chapter" data-level="3.8" data-path="accessingData.html"><a href="accessingData.html#tellme"><i class="fa fa-check"></i><b>3.8</b> Check if new data are available</a></li>
<li class="chapter" data-level="3.9" data-path="accessingData.html"><a href="accessingData.html#forceMeta"><i class="fa fa-check"></i><b>3.9</b> Force an update/re-import of tag and receiver deployment metadata</a></li>
<li class="chapter" data-level="3.10" data-path="accessingData.html"><a href="accessingData.html#metadata"><i class="fa fa-check"></i><b>3.10</b> Import full tag and receiver metadata</a></li>
<li class="chapter" data-level="3.11" data-path="accessingData.html"><a href="accessingData.html#checkVersion"><i class="fa fa-check"></i><b>3.11</b> Ensure that you have the correct database version</a></li>
<li class="chapter" data-level="3.12" data-path="accessingData.html"><a href="accessingData.html#r-object-naming-convention"><i class="fa fa-check"></i><b>3.12</b> R object naming convention</a></li>
<li class="chapter" data-level="3.13" data-path="accessingData.html"><a href="accessingData.html#importSummary"><i class="fa fa-check"></i><b>3.13</b> Summary: download, access, and export data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="deployments.html"><a href="deployments.html"><i class="fa fa-check"></i><b>4</b> Tag and Receiver Deployments</a><ul>
<li class="chapter" data-level="4.1" data-path="deployments.html"><a href="deployments.html#load-relevant-r-packages-and-set-working-environment"><i class="fa fa-check"></i><b>4.1</b> Load relevant R packages and set working environment</a></li>
<li class="chapter" data-level="4.2" data-path="deployments.html"><a href="deployments.html#load-.motus-file"><i class="fa fa-check"></i><b>4.2</b> Load .motus file</a></li>
<li class="chapter" data-level="4.3" data-path="deployments.html"><a href="deployments.html#tagDeployments"><i class="fa fa-check"></i><b>4.3</b> Tag Deployments</a><ul>
<li class="chapter" data-level="4.3.1" data-path="deployments.html"><a href="deployments.html#download-full-project-tag-metadata"><i class="fa fa-check"></i><b>4.3.1</b> Download full project tag metadata</a></li>
<li class="chapter" data-level="4.3.2" data-path="deployments.html"><a href="deployments.html#number-of-registered-tags"><i class="fa fa-check"></i><b>4.3.2</b> Number of registered tags</a></li>
<li class="chapter" data-level="4.3.3" data-path="deployments.html"><a href="deployments.html#number-of-registered-tags-that-were-deployed"><i class="fa fa-check"></i><b>4.3.3</b> Number of registered tags that were deployed</a></li>
<li class="chapter" data-level="4.3.4" data-path="deployments.html"><a href="deployments.html#checkNumberTagDeployments"><i class="fa fa-check"></i><b>4.3.4</b> Number of deployments per tag</a></li>
<li class="chapter" data-level="4.3.5" data-path="deployments.html"><a href="deployments.html#location-of-tag-deployments"><i class="fa fa-check"></i><b>4.3.5</b> Location of tag deployments</a></li>
<li class="chapter" data-level="4.3.6" data-path="deployments.html"><a href="deployments.html#check-completeness-and-accuracy-of-tag-deployment-metadata"><i class="fa fa-check"></i><b>4.3.6</b> Check completeness and accuracy of tag deployment metadata</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="deployments.html"><a href="deployments.html#recvMetadata"><i class="fa fa-check"></i><b>4.4</b> Check Receiver Metadata</a><ul>
<li class="chapter" data-level="4.4.1" data-path="deployments.html"><a href="deployments.html#download-full-receiver-metadata"><i class="fa fa-check"></i><b>4.4.1</b> Download full receiver metadata</a></li>
<li class="chapter" data-level="4.4.2" data-path="deployments.html"><a href="deployments.html#number-of-project-receiver-deployments"><i class="fa fa-check"></i><b>4.4.2</b> Number of project receiver deployments</a></li>
<li class="chapter" data-level="4.4.3" data-path="deployments.html"><a href="deployments.html#timing-of-project-receiver-deployments"><i class="fa fa-check"></i><b>4.4.3</b> Timing of project receiver deployments</a></li>
<li class="chapter" data-level="4.4.4" data-path="deployments.html"><a href="deployments.html#location-of-receiver-deployments"><i class="fa fa-check"></i><b>4.4.4</b> Location of receiver deployments</a></li>
<li class="chapter" data-level="4.4.5" data-path="deployments.html"><a href="deployments.html#completeness-and-accuracy-of-receiver-metadata"><i class="fa fa-check"></i><b>4.4.5</b> Completeness and accuracy of receiver metadata</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataCleaning.html"><a href="dataCleaning.html"><i class="fa fa-check"></i><b>5</b> Data Cleaning</a><ul>
<li class="chapter" data-level="5.1" data-path="dataCleaning.html"><a href="dataCleaning.html#loadDetectionsCleaning"><i class="fa fa-check"></i><b>5.1</b> Load required packages</a></li>
<li class="chapter" data-level="5.2" data-path="dataCleaning.html"><a href="dataCleaning.html#load-detections-data"><i class="fa fa-check"></i><b>5.2</b> Load detections data</a></li>
<li class="chapter" data-level="5.3" data-path="dataCleaning.html"><a href="dataCleaning.html#assessTagDetections"><i class="fa fa-check"></i><b>5.3</b> Assess tag detections</a></li>
<li class="chapter" data-level="5.4" data-path="dataCleaning.html"><a href="dataCleaning.html#preliminary-filtering"><i class="fa fa-check"></i><b>5.4</b> Preliminary filtering</a><ul>
<li class="chapter" data-level="5.4.1" data-path="dataCleaning.html"><a href="dataCleaning.html#understanding-the-motusfilter"><i class="fa fa-check"></i><b>5.4.1</b> Understanding the <code>motusFilter</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="dataCleaning.html"><a href="dataCleaning.html#how-the-motusfilter-is-generated"><i class="fa fa-check"></i><b>5.4.2</b> How the <code>motusFilter</code> is generated</a></li>
<li class="chapter" data-level="5.4.3" data-path="dataCleaning.html"><a href="dataCleaning.html#custom-filters-with-the-filterbyactivity-function"><i class="fa fa-check"></i><b>5.4.3</b> Custom filters with the <code>filterByActivity()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="dataCleaning.html"><a href="dataCleaning.html#preparing-the-data"><i class="fa fa-check"></i><b>5.5</b> Preparing the data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="dataCleaning.html"><a href="dataCleaning.html#label-detections-by-probability"><i class="fa fa-check"></i><b>5.5.1</b> Label detections by probability</a></li>
<li class="chapter" data-level="5.5.2" data-path="dataCleaning.html"><a href="dataCleaning.html#clean-up"><i class="fa fa-check"></i><b>5.5.2</b> Clean up</a></li>
<li class="chapter" data-level="5.5.3" data-path="dataCleaning.html"><a href="dataCleaning.html#add-gps-data"><i class="fa fa-check"></i><b>5.5.3</b> Add GPS data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="dataCleaning.html"><a href="dataCleaning.html#preliminary-data-checks"><i class="fa fa-check"></i><b>5.6</b> Preliminary data checks</a><ul>
<li class="chapter" data-level="5.6.1" data-path="dataCleaning.html"><a href="dataCleaning.html#summarize-tag-detections"><i class="fa fa-check"></i><b>5.6.1</b> Summarize tag detections</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="dataCleaning.html"><a href="dataCleaning.html#ambigs"><i class="fa fa-check"></i><b>5.7</b> Examining ambiguous detections</a></li>
<li class="chapter" data-level="5.8" data-path="dataCleaning.html"><a href="dataCleaning.html#checking-validity-of-run-lengths-of-2-or-3"><i class="fa fa-check"></i><b>5.8</b> Checking validity of run lengths of 2 or 3</a></li>
<li class="chapter" data-level="5.9" data-path="dataCleaning.html"><a href="dataCleaning.html#filtering-the-data"><i class="fa fa-check"></i><b>5.9</b> Filtering the data</a><ul>
<li class="chapter" data-level="5.9.1" data-path="dataCleaning.html"><a href="dataCleaning.html#filter-and-save-to-rds"><i class="fa fa-check"></i><b>5.9.1</b> Filter and save to RDS</a></li>
<li class="chapter" data-level="5.9.2" data-path="dataCleaning.html"><a href="dataCleaning.html#saveFilter"><i class="fa fa-check"></i><b>5.9.2</b> Save a custom filter in the motus database, and apply it to the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploreData.html"><a href="exploreData.html"><i class="fa fa-check"></i><b>6</b> Exploring data with the Motus R package</a><ul>
<li class="chapter" data-level="6.1" data-path="exploreData.html"><a href="exploreData.html#load-required-packages"><i class="fa fa-check"></i><b>6.1</b> Load required packages</a></li>
<li class="chapter" data-level="6.2" data-path="exploreData.html"><a href="exploreData.html#load-data"><i class="fa fa-check"></i><b>6.2</b> Load data</a></li>
<li class="chapter" data-level="6.3" data-path="exploreData.html"><a href="exploreData.html#dataSummaries"><i class="fa fa-check"></i><b>6.3</b> Summarizing your data</a></li>
<li class="chapter" data-level="6.4" data-path="exploreData.html"><a href="exploreData.html#dataPlotting"><i class="fa fa-check"></i><b>6.4</b> Plotting your data</a></li>
<li class="chapter" data-level="6.5" data-path="exploreData.html"><a href="exploreData.html#mappingData"><i class="fa fa-check"></i><b>6.5</b> Mapping your data</a><ul>
<li class="chapter" data-level="6.5.1" data-path="exploreData.html"><a href="exploreData.html#ggmaps"><i class="fa fa-check"></i><b>6.5.1</b> Mapping with the <code>ggmap</code> package</a></li>
<li class="chapter" data-level="6.5.2" data-path="exploreData.html"><a href="exploreData.html#outlineMaps"><i class="fa fa-check"></i><b>6.5.2</b> Creating simple outline maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="vanishingBearings.html"><a href="vanishingBearings.html"><i class="fa fa-check"></i><b>7</b> Vanishing bearings</a><ul>
<li class="chapter" data-level="7.1" data-path="vanishingBearings.html"><a href="vanishingBearings.html#thingsToBeAwareOf"><i class="fa fa-check"></i><b>7.1</b> Things to be aware of</a></li>
<li class="chapter" data-level="7.2" data-path="vanishingBearings.html"><a href="vanishingBearings.html#estimateBearings"><i class="fa fa-check"></i><b>7.2</b> Estimate vanishing bearings: step-by-step</a><ul>
<li class="chapter" data-level="7.2.1" data-path="vanishingBearings.html"><a href="vanishingBearings.html#loadPackages7"><i class="fa fa-check"></i><b>7.2.1</b> Load the required packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="vanishingBearings.html"><a href="vanishingBearings.html#vanishingSample"><i class="fa fa-check"></i><b>7.2.2</b> Load the sample data</a></li>
<li class="chapter" data-level="7.2.3" data-path="vanishingBearings.html"><a href="vanishingBearings.html#select-individuals-that-show-clear-departure-detections"><i class="fa fa-check"></i><b>7.2.3</b> Select individuals that show clear departure detections</a></li>
<li class="chapter" data-level="7.2.4" data-path="vanishingBearings.html"><a href="vanishingBearings.html#obtain-departure-times"><i class="fa fa-check"></i><b>7.2.4</b> Obtain departure times</a></li>
<li class="chapter" data-level="7.2.5" data-path="vanishingBearings.html"><a href="vanishingBearings.html#calculate-vanishing-bearings-for-individuals-with-departure-times."><i class="fa fa-check"></i><b>7.2.5</b> Calculate vanishing bearings for individuals with departure times.</a></li>
<li class="chapter" data-level="7.2.6" data-path="vanishingBearings.html"><a href="vanishingBearings.html#plot-the-vanishing-bearings-on-a-map"><i class="fa fa-check"></i><b>7.2.6</b> Plot the vanishing bearings on a map</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="vanishingBearings.html"><a href="vanishingBearings.html#vanishingLitCited"><i class="fa fa-check"></i><b>7.3</b> Literature Cited</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advancedModelling.html"><a href="advancedModelling.html"><i class="fa fa-check"></i><b>8</b> Advanced modelling and analysis</a></li>
<li class="chapter" data-level="9" data-path="falsePositives.html"><a href="falsePositives.html"><i class="fa fa-check"></i><b>9</b> A tool to identify probable false positive detections</a><ul>
<li class="chapter" data-level="9.1" data-path="falsePositives.html"><a href="falsePositives.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="falsePositives.html"><a href="falsePositives.html#step-1-classification-of-detections"><i class="fa fa-check"></i><b>9.2</b> Step 1 – Classification of detections</a></li>
<li class="chapter" data-level="9.3" data-path="falsePositives.html"><a href="falsePositives.html#step-2-identification-of-potential-diagnostic-parameters"><i class="fa fa-check"></i><b>9.3</b> Step 2 – Identification of potential diagnostic parameters</a></li>
<li class="chapter" data-level="9.4" data-path="falsePositives.html"><a href="falsePositives.html#step-3-prediction-of-the-probability-of-being-a-false-positive"><i class="fa fa-check"></i><b>9.4</b> Step 3 – Prediction of the probability of being a false positive</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixA.html"><a href="appendixA.html"><i class="fa fa-check"></i><b>A</b> Appendix - <code>alltags</code> and <code>alltagsGPS</code> structure</a></li>
<li class="chapter" data-level="B" data-path="appendixB.html"><a href="appendixB.html"><i class="fa fa-check"></i><b>B</b> Appendix - Troubleshooting</a><ul>
<li class="chapter" data-level="B.1" data-path="appendixB.html"><a href="appendixB.html#general-problems"><i class="fa fa-check"></i><b>B.1</b> General Problems</a></li>
<li class="chapter" data-level="B.2" data-path="appendixB.html"><a href="appendixB.html#motusLogout"><i class="fa fa-check"></i><b>B.2</b> Logging out of motus</a></li>
<li class="chapter" data-level="B.3" data-path="appendixB.html"><a href="appendixB.html#resumeDownload"><i class="fa fa-check"></i><b>B.3</b> Resume data download</a></li>
<li class="chapter" data-level="B.4" data-path="appendixB.html"><a href="appendixB.html#googleMapsKey"><i class="fa fa-check"></i><b>B.4</b> Google Maps</a></li>
<li class="chapter" data-level="B.5" data-path="appendixB.html"><a href="appendixB.html#common-problems-and-solutions"><i class="fa fa-check"></i><b>B.5</b> Common problems and solutions:</a><ul>
<li class="chapter" data-level="B.5.1" data-path="appendixB.html"><a href="appendixB.html#i-cannot-access-project-176-i-download-0-records-from-project-176"><i class="fa fa-check"></i><b>B.5.1</b> I cannot access Project 176 / I download 0 records from Project 176</a></li>
<li class="chapter" data-level="B.5.2" data-path="appendixB.html"><a href="appendixB.html#i-get-the-message-auto-disconnecting-sqliteconnection-one-or-multiple-times-after-using-tagme"><i class="fa fa-check"></i><b>B.5.2</b> I get the message “Auto-disconnecting SQLiteConnection” one or multiple times after using tagme()</a></li>
<li class="chapter" data-level="B.5.3" data-path="appendixB.html"><a href="appendixB.html#i-get-an-internal-server-error-message-when-using-tagme-update-true"><i class="fa fa-check"></i><b>B.5.3</b> I get an “Internal Server Error” message when using tagme(…, update = TRUE)</a></li>
<li class="chapter" data-level="B.5.4" data-path="appendixB.html"><a href="appendixB.html#i-get-an-error-forbidden-message-when-using-tagme"><i class="fa fa-check"></i><b>B.5.4</b> I get an “Error: Forbidden” message when using tagme()</a></li>
<li class="chapter" data-level="B.5.5" data-path="appendixB.html"><a href="appendixB.html#i-get-an-error-object-xxxx-not-found-referring-to-a-table-or-field-name-or-some-of-your-examples-in-the-book-do-not-work."><i class="fa fa-check"></i><b>B.5.5</b> I get an error “Object ‘xxxx’ not found”, referring to a table or field name, or some of your examples in the book do not work.</a></li>
<li class="chapter" data-level="B.5.6" data-path="appendixB.html"><a href="appendixB.html#i-get-an-error-error-in-rsqlite_connectdbname-loadable.extensions-flags-vfs-could-not-connect-to-database-unable-to-open-database-file-when-attempting-to-run-tagme"><i class="fa fa-check"></i><b>B.5.6</b> I get an error <code>Error in rsqlite_connect(dbname, loadable.extensions, flags, vfs) : Could not connect to database: unable to open database file</code> when attempting to run <code>tagme()</code></a></li>
<li class="chapter" data-level="B.5.7" data-path="appendixB.html"><a href="appendixB.html#i-see-gps-coordinates-of-0-or-999"><i class="fa fa-check"></i><b>B.5.7</b> I see GPS coordinates of “0” or “999”</a></li>
<li class="chapter" data-level="B.5.8" data-path="appendixB.html"><a href="appendixB.html#i-see-port-with-a-value-of--1"><i class="fa fa-check"></i><b>B.5.8</b> I see port with a value of -1</a></li>
<li class="chapter" data-level="B.5.9" data-path="appendixB.html"><a href="appendixB.html#i-get-the-error-error-in-rsqlite_fetchresptr-n-n-database-disk-image-is-malformed"><i class="fa fa-check"></i><b>B.5.9</b> I get the error <code>Error in rsqlite_fetch(res@ptr, n = n) : database disk image is malformed</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="appendixC.html"><a href="appendixC.html"><i class="fa fa-check"></i><b>C</b> Appendix - <code>motus</code> - Summary and plotting functions</a><ul>
<li class="chapter" data-level="C.1" data-path="appendixC.html"><a href="appendixC.html#checkVersionB"><i class="fa fa-check"></i><b>C.1</b> <code>checkVersion</code></a><ul>
<li class="chapter" data-level="C.1.1" data-path="appendixC.html"><a href="appendixC.html#description"><i class="fa fa-check"></i><b>C.1.1</b> Description</a></li>
<li class="chapter" data-level="C.1.2" data-path="appendixC.html"><a href="appendixC.html#arguments"><i class="fa fa-check"></i><b>C.1.2</b> Arguments</a></li>
<li class="chapter" data-level="C.1.3" data-path="appendixC.html"><a href="appendixC.html#example"><i class="fa fa-check"></i><b>C.1.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="appendixC.html"><a href="appendixC.html#sunRiseSet"><i class="fa fa-check"></i><b>C.2</b> <code>sunRiseSet</code></a><ul>
<li class="chapter" data-level="C.2.1" data-path="appendixC.html"><a href="appendixC.html#description-1"><i class="fa fa-check"></i><b>C.2.1</b> Description</a></li>
<li class="chapter" data-level="C.2.2" data-path="appendixC.html"><a href="appendixC.html#arguments-1"><i class="fa fa-check"></i><b>C.2.2</b> Arguments</a></li>
<li class="chapter" data-level="C.2.3" data-path="appendixC.html"><a href="appendixC.html#example-1"><i class="fa fa-check"></i><b>C.2.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="appendixC.html"><a href="appendixC.html#plotAllTagsCoord"><i class="fa fa-check"></i><b>C.3</b> <code>plotAllTagsCoord</code></a><ul>
<li class="chapter" data-level="C.3.1" data-path="appendixC.html"><a href="appendixC.html#description-2"><i class="fa fa-check"></i><b>C.3.1</b> Description</a></li>
<li class="chapter" data-level="C.3.2" data-path="appendixC.html"><a href="appendixC.html#arguments-2"><i class="fa fa-check"></i><b>C.3.2</b> Arguments</a></li>
<li class="chapter" data-level="C.3.3" data-path="appendixC.html"><a href="appendixC.html#example-2"><i class="fa fa-check"></i><b>C.3.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="appendixC.html"><a href="appendixC.html#plotAllTagsSite"><i class="fa fa-check"></i><b>C.4</b> <code>plotAllTagsSite</code></a><ul>
<li class="chapter" data-level="C.4.1" data-path="appendixC.html"><a href="appendixC.html#description-3"><i class="fa fa-check"></i><b>C.4.1</b> Description</a></li>
<li class="chapter" data-level="C.4.2" data-path="appendixC.html"><a href="appendixC.html#arguments-3"><i class="fa fa-check"></i><b>C.4.2</b> Arguments</a></li>
<li class="chapter" data-level="C.4.3" data-path="appendixC.html"><a href="appendixC.html#example-3"><i class="fa fa-check"></i><b>C.4.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="appendixC.html"><a href="appendixC.html#plotDailySiteSum"><i class="fa fa-check"></i><b>C.5</b> <code>plotDailySiteSum</code></a><ul>
<li class="chapter" data-level="C.5.1" data-path="appendixC.html"><a href="appendixC.html#description-4"><i class="fa fa-check"></i><b>C.5.1</b> Description</a></li>
<li class="chapter" data-level="C.5.2" data-path="appendixC.html"><a href="appendixC.html#arguments-4"><i class="fa fa-check"></i><b>C.5.2</b> Arguments</a></li>
<li class="chapter" data-level="C.5.3" data-path="appendixC.html"><a href="appendixC.html#example-4"><i class="fa fa-check"></i><b>C.5.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="appendixC.html"><a href="appendixC.html#plotRouteMap"><i class="fa fa-check"></i><b>C.6</b> <code>plotRouteMap</code></a><ul>
<li class="chapter" data-level="C.6.1" data-path="appendixC.html"><a href="appendixC.html#description-5"><i class="fa fa-check"></i><b>C.6.1</b> Description</a></li>
<li class="chapter" data-level="C.6.2" data-path="appendixC.html"><a href="appendixC.html#example-5"><i class="fa fa-check"></i><b>C.6.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.7" data-path="appendixC.html"><a href="appendixC.html#plotSite"><i class="fa fa-check"></i><b>C.7</b> <code>plotSite</code></a><ul>
<li class="chapter" data-level="C.7.1" data-path="appendixC.html"><a href="appendixC.html#description-6"><i class="fa fa-check"></i><b>C.7.1</b> Description</a></li>
<li class="chapter" data-level="C.7.2" data-path="appendixC.html"><a href="appendixC.html#arguments-5"><i class="fa fa-check"></i><b>C.7.2</b> Arguments</a></li>
<li class="chapter" data-level="C.7.3" data-path="appendixC.html"><a href="appendixC.html#example-6"><i class="fa fa-check"></i><b>C.7.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.8" data-path="appendixC.html"><a href="appendixC.html#plotSiteSig"><i class="fa fa-check"></i><b>C.8</b> <code>plotSiteSig</code></a><ul>
<li class="chapter" data-level="C.8.1" data-path="appendixC.html"><a href="appendixC.html#description-7"><i class="fa fa-check"></i><b>C.8.1</b> Description</a></li>
<li class="chapter" data-level="C.8.2" data-path="appendixC.html"><a href="appendixC.html#arguments-6"><i class="fa fa-check"></i><b>C.8.2</b> Arguments</a></li>
<li class="chapter" data-level="C.8.3" data-path="appendixC.html"><a href="appendixC.html#example-7"><i class="fa fa-check"></i><b>C.8.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.9" data-path="appendixC.html"><a href="appendixC.html#plotTagSig"><i class="fa fa-check"></i><b>C.9</b> <code>plotTagSig</code></a><ul>
<li class="chapter" data-level="C.9.1" data-path="appendixC.html"><a href="appendixC.html#description-8"><i class="fa fa-check"></i><b>C.9.1</b> Description</a></li>
<li class="chapter" data-level="C.9.2" data-path="appendixC.html"><a href="appendixC.html#arguments-7"><i class="fa fa-check"></i><b>C.9.2</b> Arguments</a></li>
<li class="chapter" data-level="C.9.3" data-path="appendixC.html"><a href="appendixC.html#example-8"><i class="fa fa-check"></i><b>C.9.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.10" data-path="appendixC.html"><a href="appendixC.html#simSiteDet"><i class="fa fa-check"></i><b>C.10</b> <code>simSiteDet</code></a><ul>
<li class="chapter" data-level="C.10.1" data-path="appendixC.html"><a href="appendixC.html#description-9"><i class="fa fa-check"></i><b>C.10.1</b> Description</a></li>
<li class="chapter" data-level="C.10.2" data-path="appendixC.html"><a href="appendixC.html#arguments-8"><i class="fa fa-check"></i><b>C.10.2</b> Arguments</a></li>
<li class="chapter" data-level="C.10.3" data-path="appendixC.html"><a href="appendixC.html#example-9"><i class="fa fa-check"></i><b>C.10.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.11" data-path="appendixC.html"><a href="appendixC.html#siteSum"><i class="fa fa-check"></i><b>C.11</b> <code>siteSum</code></a><ul>
<li class="chapter" data-level="C.11.1" data-path="appendixC.html"><a href="appendixC.html#description-10"><i class="fa fa-check"></i><b>C.11.1</b> Description</a></li>
<li class="chapter" data-level="C.11.2" data-path="appendixC.html"><a href="appendixC.html#arguments-9"><i class="fa fa-check"></i><b>C.11.2</b> Arguments</a></li>
<li class="chapter" data-level="C.11.3" data-path="appendixC.html"><a href="appendixC.html#example-10"><i class="fa fa-check"></i><b>C.11.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.12" data-path="appendixC.html"><a href="appendixC.html#siteSumDaily"><i class="fa fa-check"></i><b>C.12</b> <code>siteSumDaily</code></a><ul>
<li class="chapter" data-level="C.12.1" data-path="appendixC.html"><a href="appendixC.html#description-11"><i class="fa fa-check"></i><b>C.12.1</b> Description</a></li>
<li class="chapter" data-level="C.12.2" data-path="appendixC.html"><a href="appendixC.html#arguments-10"><i class="fa fa-check"></i><b>C.12.2</b> Arguments</a></li>
<li class="chapter" data-level="C.12.3" data-path="appendixC.html"><a href="appendixC.html#example-11"><i class="fa fa-check"></i><b>C.12.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.13" data-path="appendixC.html"><a href="appendixC.html#siteTrans"><i class="fa fa-check"></i><b>C.13</b> <code>siteTrans</code></a><ul>
<li class="chapter" data-level="C.13.1" data-path="appendixC.html"><a href="appendixC.html#description-12"><i class="fa fa-check"></i><b>C.13.1</b> Description</a></li>
<li class="chapter" data-level="C.13.2" data-path="appendixC.html"><a href="appendixC.html#arguments-11"><i class="fa fa-check"></i><b>C.13.2</b> Arguments</a></li>
<li class="chapter" data-level="C.13.3" data-path="appendixC.html"><a href="appendixC.html#example-12"><i class="fa fa-check"></i><b>C.13.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.14" data-path="appendixC.html"><a href="appendixC.html#tagSum"><i class="fa fa-check"></i><b>C.14</b> <code>tagSum</code></a><ul>
<li class="chapter" data-level="C.14.1" data-path="appendixC.html"><a href="appendixC.html#description-13"><i class="fa fa-check"></i><b>C.14.1</b> Description</a></li>
<li class="chapter" data-level="C.14.2" data-path="appendixC.html"><a href="appendixC.html#arguments-12"><i class="fa fa-check"></i><b>C.14.2</b> Arguments</a></li>
<li class="chapter" data-level="C.14.3" data-path="appendixC.html"><a href="appendixC.html#example-13"><i class="fa fa-check"></i><b>C.14.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.15" data-path="appendixC.html"><a href="appendixC.html#tagSumSite"><i class="fa fa-check"></i><b>C.15</b> <code>tagSumSite</code></a><ul>
<li class="chapter" data-level="C.15.1" data-path="appendixC.html"><a href="appendixC.html#description-14"><i class="fa fa-check"></i><b>C.15.1</b> Description</a></li>
<li class="chapter" data-level="C.15.2" data-path="appendixC.html"><a href="appendixC.html#arguments-13"><i class="fa fa-check"></i><b>C.15.2</b> Arguments</a></li>
<li class="chapter" data-level="C.15.3" data-path="appendixC.html"><a href="appendixC.html#example-14"><i class="fa fa-check"></i><b>C.15.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="C.16" data-path="appendixC.html"><a href="appendixC.html#timeToSunriset"><i class="fa fa-check"></i><b>C.16</b> <code>timeToSunriset</code></a><ul>
<li class="chapter" data-level="C.16.1" data-path="appendixC.html"><a href="appendixC.html#description-15"><i class="fa fa-check"></i><b>C.16.1</b> Description</a></li>
<li class="chapter" data-level="C.16.2" data-path="appendixC.html"><a href="appendixC.html#arguments-14"><i class="fa fa-check"></i><b>C.16.2</b> Arguments</a></li>
<li class="chapter" data-level="C.16.3" data-path="appendixC.html"><a href="appendixC.html#example-15"><i class="fa fa-check"></i><b>C.16.3</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="appendixD.html"><a href="appendixD.html"><i class="fa fa-check"></i><b>D</b> Appendix - <code>motus</code> - Data filtering functions</a><ul>
<li class="chapter" data-level="D.1" data-path="appendixD.html"><a href="appendixD.html#listRunsFilters"><i class="fa fa-check"></i><b>D.1</b> <code>listRunsFilters</code></a><ul>
<li class="chapter" data-level="D.1.1" data-path="appendixD.html"><a href="appendixD.html#description-16"><i class="fa fa-check"></i><b>D.1.1</b> Description</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="appendixD.html"><a href="appendixD.html#arguments-15"><i class="fa fa-check"></i><b>D.2</b> Arguments</a></li>
<li class="chapter" data-level="D.3" data-path="appendixD.html"><a href="appendixD.html#example-16"><i class="fa fa-check"></i><b>D.3</b> Example</a></li>
<li class="chapter" data-level="D.4" data-path="appendixD.html"><a href="appendixD.html#createRunsFilter"><i class="fa fa-check"></i><b>D.4</b> <code>createRunsFilter</code></a><ul>
<li class="chapter" data-level="D.4.1" data-path="appendixD.html"><a href="appendixD.html#description-17"><i class="fa fa-check"></i><b>D.4.1</b> Description</a></li>
<li class="chapter" data-level="D.4.2" data-path="appendixD.html"><a href="appendixD.html#arguments-16"><i class="fa fa-check"></i><b>D.4.2</b> Arguments</a></li>
<li class="chapter" data-level="D.4.3" data-path="appendixD.html"><a href="appendixD.html#example-17"><i class="fa fa-check"></i><b>D.4.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="appendixD.html"><a href="appendixD.html#getRunsFilters"><i class="fa fa-check"></i><b>D.5</b> <code>getRunsFilters</code></a><ul>
<li class="chapter" data-level="D.5.1" data-path="appendixD.html"><a href="appendixD.html#description-18"><i class="fa fa-check"></i><b>D.5.1</b> Description</a></li>
<li class="chapter" data-level="D.5.2" data-path="appendixD.html"><a href="appendixD.html#arguments-17"><i class="fa fa-check"></i><b>D.5.2</b> Arguments</a></li>
<li class="chapter" data-level="D.5.3" data-path="appendixD.html"><a href="appendixD.html#example-18"><i class="fa fa-check"></i><b>D.5.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="D.6" data-path="appendixD.html"><a href="appendixD.html#writeRunsFilter"><i class="fa fa-check"></i><b>D.6</b> <code>writeRunsFilter</code></a><ul>
<li class="chapter" data-level="D.6.1" data-path="appendixD.html"><a href="appendixD.html#description-19"><i class="fa fa-check"></i><b>D.6.1</b> Description</a></li>
<li class="chapter" data-level="D.6.2" data-path="appendixD.html"><a href="appendixD.html#arguments-18"><i class="fa fa-check"></i><b>D.6.2</b> Arguments</a></li>
<li class="chapter" data-level="D.6.3" data-path="appendixD.html"><a href="appendixD.html#examples"><i class="fa fa-check"></i><b>D.6.3</b> Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html"><i class="fa fa-check"></i><b>E</b> Bird’s Eye View of Motus Data</a><ul>
<li class="chapter" data-level="E.1" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#what-data-look-like"><i class="fa fa-check"></i><b>E.1</b> What data look like</a></li>
<li class="chapter" data-level="E.2" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#false-positives"><i class="fa fa-check"></i><b>E.2</b> False positives</a></li>
<li class="chapter" data-level="E.3" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#false-negatives"><i class="fa fa-check"></i><b>E.3</b> False negatives</a></li>
<li class="chapter" data-level="E.4" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#complication-data-are-processed-in-batches"><i class="fa fa-check"></i><b>E.4</b> Complication: data are processed in batches</a></li>
<li class="chapter" data-level="E.5" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#batches"><i class="fa fa-check"></i><b>E.5</b> Batches</a><ul>
<li class="chapter" data-level="E.5.1" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#receiver-reboots"><i class="fa fa-check"></i><b>E.5.1</b> Receiver Reboots</a></li>
<li class="chapter" data-level="E.5.2" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#incremental-distribution-of-data"><i class="fa fa-check"></i><b>E.5.2</b> Incremental Distribution of Data</a></li>
</ul></li>
<li class="chapter" data-level="E.6" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#reprocessing-data"><i class="fa fa-check"></i><b>E.6</b> Reprocessing Data</a></li>
<li class="chapter" data-level="E.7" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#the-eventual-reprocessing-contract"><i class="fa fa-check"></i><b>E.7</b> The (eventual) Reprocessing Contract</a></li>
<li class="chapter" data-level="E.8" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#reprocessing-simplified-only-by-boot-session"><i class="fa fa-check"></i><b>E.8</b> Reprocessing simplified: only by boot session</a></li>
<li class="chapter" data-level="E.9" data-path="birds-eye-view-of-motus-data.html"><a href="birds-eye-view-of-motus-data.html#distributing-reprocessed-data"><i class="fa fa-check"></i><b>E.9</b> Distributing reprocessed data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Motus R Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="falsePositives" class="section level1">
<h1><span class="header-section-number">9</span> A tool to identify probable false positive detections</h1>
<p><em>This chapter was contributed by Bianca Michalik, Amie MacDonald, and Philip Taylor.</em></p>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">9.1</span> Introduction</h2>
<p>As outlined in Chapter <a href="dataCleaning.html#dataCleaning">5</a>, there are several factors that might lead to false detections of your tags in your datasets. One type of these false detections are so called <em>false positives</em>, which can arise from other sources of electromagnetic pulses in the surroundings of receiving antennas. False positives are liberally allowed for during automated tag filtering at Motus to minimize the risk of missing any real detections. Therefore, we generally recommend you use the tools provided in section <a href="dataCleaning.html#assessTagDetections">5.3</a> to validate your data and to decide individually if a detection is valid in a biological context. However, this approach can be quite time consuming, especially when you are fortunate enough to have deployed lots of tags and consequently, you have a huge dataset. Furthermore, it can sometimes be critical to formulate exactly the conditions under which you might have excluded a detection from your further analyses if you did this by visual inspection of diagnostic plots.</p>
<p>The goal of this chapter is to provide a tool to automatically predict the probability of a detection of being a false positive. The concept of our approach is quite simple: first, we want to use a subset of detection data from a solid <em>a priori</em> classification of detections either being ‘good’ or ‘bad’. In the second step, we want to identify potential diagnostic physical parameters provided in the Motus <code>alltags</code> table (please see Appendix <a href="appendixA.html#appendixA">A</a> for a detailed description of variables) to characterize the quality of a detection. Third, we run a logistic regression model with these parameters in order to predict the probability of each detection being a ‘bad’ detection for all of your detection data. Finally, you can use the probability estimates provided from the model to define a threshold for filtering your data. Of course, it is generally necessary to re-evaluate the outcome of this process in a biological context.</p>
<p>While this chapter primarily applies to detection of Lotek nanotags, detections from Cellular Tracking Technologies (CTT) PowerTags and LifeTags are also subject to false detections. Because the properties and the processing of the data are quite distinct, the topic of false detections in CTT tags will be covered in a different chapter at a later time. However, some of the principles explained here will apply to both types of tags, particularly the idea that longer, uninterrupted sequences of bursts matching the expected burst period will have a higher probability of being true detections.</p>
</div>
<div id="step-1-classification-of-detections" class="section level2">
<h2><span class="header-section-number">9.2</span> Step 1 – Classification of detections</h2>
<p>False positives resulting from random radio noise are often characterized by three simultaneously occurring features. First, the run lengths of these false detections are typically quite short. A ‘run’ is a series of consecutive bursts of a given tag detected by the same antenna at the same receiver. Short run lengths mean that only a few recorded consecutive bursts are identified to match a specific tag. This feature arises from simple probability statistics: in a series of random pulses it is more likely to find the specific signal pattern of a tag only by chance if that pattern is short, which is usually the case in most of the tags registered with Motus. The detection probability of a deployed tag also depends on its burst interval meaning that longer burst intervals have a lower probability of being detected. Tags with long burst intervals thus tend to be recorded less often as the animal moves ‘out of the beam’ of the recording antenna. Tags with short burst intervals, in turn, tend to be recorded with a longer run length, therefore bearing higher probabilities of being a false positive with a long run length.</p>
<p>The second common feature of false detections is that within a run a lot of bursts are missed. During the process of automated tag filtering up to 60 bursts can be missed without the run being terminated for the identified tag. This makes biological sense as the detection probability of a tag deployed on a moving animal also depends on the structure and type of the landscape, the orientation of the antenna of the tag as well as on the distance and height the animal is moving relative to the recording antenna. If the animal drops in height, vanishes behind a structure or if it quickly turns its body axis, recordings of the tag can be interrupted, i.e. bursts can be missed. Recordings with a very high amount of missed bursts, however, might be less trustworthy.</p>
<p>The third feature is that the time intervals of the recorded bursts might not properly match the time intervals as specified by the manufacturer and recorded during tag registration. For technical reasons, there is a certain offset allowed for during automated tag filtering at Motus (+/-4 ms), indicated in the <code>alltags</code> variable <code>slop</code> (see Appendix <a href="appendixA.html#appendixA">A</a> for detailed explanation of variables). The variable <code>burstSlop</code> is the signed time offset of a recorded burst relative to its expected position in the recorded time sequence based on the tag registration burst interval which allows for bursts to be missed. If you calculate ‘measured’ burst intervals between two subsequently recorded bursts of the same tag, i.e. ignoring missed bursts, they sometimes deviate widely from the burst interval as specified by the manufacturer and tag registration. These deviations can arise from accumulations of time offsets which would otherwise be neglected if missed bursts were accounted for. This means, small <code>burstSlop</code>s sometimes might suggest better recordings of a tag than they really are.</p>
<p>As pointed out, none of the three common features of false positives described above can alone describe the quality of a detection. We thus want to use all three of them to classify our detection dataset <em>a priori</em> into ‘good’ and ‘bad’ detections.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="falsePositives.html#cb224-1"></a><span class="co"># set system environment time zone to GMT</span></span>
<span id="cb224-2"><a href="falsePositives.html#cb224-2"></a><span class="kw">Sys.setenv</span>(<span class="dt">tz=</span><span class="st">&quot;GMT&quot;</span>)</span>
<span id="cb224-3"><a href="falsePositives.html#cb224-3"></a></span>
<span id="cb224-4"><a href="falsePositives.html#cb224-4"></a><span class="co"># load required packages</span></span>
<span id="cb224-5"><a href="falsePositives.html#cb224-5"></a><span class="kw">library</span>(motus)</span>
<span id="cb224-6"><a href="falsePositives.html#cb224-6"></a><span class="kw">library</span>(rms)</span>
<span id="cb224-7"><a href="falsePositives.html#cb224-7"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb224-8"><a href="falsePositives.html#cb224-8"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb224-9"><a href="falsePositives.html#cb224-9"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb224-10"><a href="falsePositives.html#cb224-10"></a></span>
<span id="cb224-11"><a href="falsePositives.html#cb224-11"></a><span class="co"># set base theme for plots</span></span>
<span id="cb224-12"><a href="falsePositives.html#cb224-12"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">18</span>))</span>
<span id="cb224-13"><a href="falsePositives.html#cb224-13"></a></span>
<span id="cb224-14"><a href="falsePositives.html#cb224-14"></a><span class="co">### download sample data from James Bay Shorebird Project #176</span></span>
<span id="cb224-15"><a href="falsePositives.html#cb224-15"></a><span class="co">#   note: if you haven&#39;t downloaded sample dataset before, use &#39;new = T&#39;</span></span>
<span id="cb224-16"><a href="falsePositives.html#cb224-16"></a><span class="co">#   specify &#39;dir =&#39; to save elsewhere than working directory</span></span>
<span id="cb224-17"><a href="falsePositives.html#cb224-17"></a>db &lt;-<span class="st"> </span><span class="kw">tagme</span>(<span class="dv">176</span>, <span class="dt">new =</span> F, <span class="dt">update =</span> F, <span class="dt">forceMeta =</span> F, <span class="dt">dir =</span> <span class="st">&quot;./data/&quot;</span>)</span>
<span id="cb224-18"><a href="falsePositives.html#cb224-18"></a></span>
<span id="cb224-19"><a href="falsePositives.html#cb224-19"></a>t &lt;-<span class="st"> </span><span class="kw">tbl</span>(db, <span class="st">&quot;alltags&quot;</span>)</span>
<span id="cb224-20"><a href="falsePositives.html#cb224-20"></a></span>
<span id="cb224-21"><a href="falsePositives.html#cb224-21"></a>df &lt;-<span class="st"> </span>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb224-22"><a href="falsePositives.html#cb224-22"></a><span class="st">  </span><span class="kw">select</span>(hitID, runID, ts, sig, sigsd, noise, freq, freqsd, slop, burstSlop,   <span class="co"># select variables</span></span>
<span id="cb224-23"><a href="falsePositives.html#cb224-23"></a>         motusTagID, port, runLen, tagModel, tagBI, tagDeployID,</span>
<span id="cb224-24"><a href="falsePositives.html#cb224-24"></a>         deviceID, recvDeployID, recvDeployLat, recvDeployLon, recv, recvSiteName) <span class="op">%&gt;%</span></span>
<span id="cb224-25"><a href="falsePositives.html#cb224-25"></a><span class="st">  </span><span class="kw">arrange</span>(motusTagID, ts) <span class="op">%&gt;%</span><span class="st">                                                  </span><span class="co"># order data frame</span></span>
<span id="cb224-26"><a href="falsePositives.html#cb224-26"></a><span class="st">  </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame <span class="op">%&gt;%</span><span class="st">                                                </span><span class="co"># convert into flat data frame</span></span>
<span id="cb224-27"><a href="falsePositives.html#cb224-27"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ts =</span> <span class="kw">as.POSIXct</span>(ts, <span class="dt">origin=</span><span class="st">&quot;1970-01-01 00:00:00&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;GMT&quot;</span>)) <span class="op">%&gt;%</span><span class="st">      </span><span class="co"># convert ts into readable format</span></span>
<span id="cb224-28"><a href="falsePositives.html#cb224-28"></a><span class="st">  </span><span class="kw">distinct</span>()</span>
<span id="cb224-29"><a href="falsePositives.html#cb224-29"></a></span>
<span id="cb224-30"><a href="falsePositives.html#cb224-30"></a><span class="kw">rm</span>(t)</span>
<span id="cb224-31"><a href="falsePositives.html#cb224-31"></a></span>
<span id="cb224-32"><a href="falsePositives.html#cb224-32"></a><span class="co"># find duplicated runIDs (duplicates in ts, motusTagID, port, recv)</span></span>
<span id="cb224-33"><a href="falsePositives.html#cb224-33"></a><span class="co"># note, there are no duplicates in the sample dataset!</span></span>
<span id="cb224-34"><a href="falsePositives.html#cb224-34"></a><span class="co"># runsDup &lt;- df %&gt;%</span></span>
<span id="cb224-35"><a href="falsePositives.html#cb224-35"></a><span class="co">#   filter(duplicated(cbind(ts, motusTagID, port, recv))==T) %&gt;%</span></span>
<span id="cb224-36"><a href="falsePositives.html#cb224-36"></a><span class="co">#   select(runID)</span></span>
<span id="cb224-37"><a href="falsePositives.html#cb224-37"></a><span class="co">#</span></span>
<span id="cb224-38"><a href="falsePositives.html#cb224-38"></a><span class="co"># filter data (remove runs with duplicates)</span></span>
<span id="cb224-39"><a href="falsePositives.html#cb224-39"></a><span class="co"># df &lt;- df %&gt;% filter(!(runID %in% runsDup$runID))</span></span>
<span id="cb224-40"><a href="falsePositives.html#cb224-40"></a><span class="co">#</span></span>
<span id="cb224-41"><a href="falsePositives.html#cb224-41"></a><span class="co"># rm(runsDup)</span></span></code></pre></div>
<p>Since we want to consider each detection within its recorded time frame, we calculate features 2 and 3 for each run individually.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="falsePositives.html#cb225-1"></a><span class="co">##### Step 1 - Classification of detections</span></span>
<span id="cb225-2"><a href="falsePositives.html#cb225-2"></a></span>
<span id="cb225-3"><a href="falsePositives.html#cb225-3"></a><span class="co">### calculate features 2 and 3 for each run</span></span>
<span id="cb225-4"><a href="falsePositives.html#cb225-4"></a>runFeat &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb225-5"><a href="falsePositives.html#cb225-5"></a><span class="st">  </span><span class="kw">group_by</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb225-6"><a href="falsePositives.html#cb225-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">duration =</span> <span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">max</span>(ts), <span class="kw">min</span>(ts), <span class="dt">units=</span><span class="st">&quot;s&quot;</span>)),</span>
<span id="cb225-7"><a href="falsePositives.html#cb225-7"></a>         <span class="dt">nPred =</span> <span class="kw">ceiling</span>(duration<span class="op">/</span>tagBI),               <span class="co"># expected number of bursts in run if none are missed</span></span>
<span id="cb225-8"><a href="falsePositives.html#cb225-8"></a>         <span class="dt">nMiss =</span> nPred <span class="op">-</span><span class="st"> </span>runLen,                        <span class="co"># number of bursts missed in run</span></span>
<span id="cb225-9"><a href="falsePositives.html#cb225-9"></a>         <span class="dt">propMiss =</span> nMiss<span class="op">/</span>nPred,                        <span class="co"># feature 2 - proportion of bursts missed in run</span></span>
<span id="cb225-10"><a href="falsePositives.html#cb225-10"></a>         <span class="dt">meanBI =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">diff</span>(ts))),           <span class="co"># mean observed burst interval based on all intervals between sequential bursts in a run</span></span>
<span id="cb225-11"><a href="falsePositives.html#cb225-11"></a>         <span class="dt">deltaMeanBI =</span> meanBI <span class="op">-</span><span class="st"> </span>tagBI) <span class="op">%&gt;%</span><span class="st">              </span><span class="co"># feature 3 - difference between observed mean burst interval and expected burst interval based from manufacturer/tag registration</span></span>
<span id="cb225-12"><a href="falsePositives.html#cb225-12"></a><span class="st">  </span><span class="kw">select</span>(runID, motusTagID, port, runLen, tagModel, tagBI,</span>
<span id="cb225-13"><a href="falsePositives.html#cb225-13"></a>         recv, recvSiteName, recvDeployLat, recvDeployLon,</span>
<span id="cb225-14"><a href="falsePositives.html#cb225-14"></a>         duration, nPred, nMiss, propMiss, meanBI, deltaMeanBI) <span class="op">%&gt;%</span></span>
<span id="cb225-15"><a href="falsePositives.html#cb225-15"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">duplicated</span>(runID)<span class="op">==</span>F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-16"><a href="falsePositives.html#cb225-16"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<p>Now, we can classify our dataset of runs into the <em>a priori</em> categories ‘good’, ‘bad’ and ‘unassigned’. We use a simple if-else statement and arbitrarily defined threshold values for each of the three features. Of course, threshold setting is up to you. We recommend a conservative classification of ‘good’ runs having less than 25% of the bursts missed or the deviation between the recorded mean burst interval and the tag burst interval should be smaller than the tag burst interval itself. ‘Bad’ runs are those recorded with run lengths smaller 4 or more than 75% of the bursts missed or the deviation between the recorded mean burst interval is more than 3 times the tag burst interval.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="falsePositives.html#cb226-1"></a><span class="co">### assign category for goodness of detection (run)</span></span>
<span id="cb226-2"><a href="falsePositives.html#cb226-2"></a><span class="co">#   filter by propMiss &gt;= 0.75, deltaMeanBI &gt;= 3*tagBI, runLen &lt; 4</span></span>
<span id="cb226-3"><a href="falsePositives.html#cb226-3"></a>runFeat<span class="op">$</span>category &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">abs</span>(runFeat<span class="op">$</span>propMiss) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span> <span class="op">|</span></span>
<span id="cb226-4"><a href="falsePositives.html#cb226-4"></a><span class="st">                               </span>runFeat<span class="op">$</span>deltaMeanBI <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>runFeat<span class="op">$</span>tagBI <span class="op">|</span></span>
<span id="cb226-5"><a href="falsePositives.html#cb226-5"></a><span class="st">                               </span>runFeat<span class="op">$</span>runLen <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>, <span class="st">&quot;bad&quot;</span>,</span>
<span id="cb226-6"><a href="falsePositives.html#cb226-6"></a>                           <span class="kw">ifelse</span>(<span class="kw">abs</span>(runFeat<span class="op">$</span>propMiss) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.25</span> <span class="op">|</span></span>
<span id="cb226-7"><a href="falsePositives.html#cb226-7"></a><span class="st">                                      </span>runFeat<span class="op">$</span>deltaMeanBI <span class="op">&lt;</span><span class="st"> </span>runFeat<span class="op">$</span>tagBI,</span>
<span id="cb226-8"><a href="falsePositives.html#cb226-8"></a>                                      <span class="st">&quot;good&quot;</span>, <span class="st">&quot;unassigned&quot;</span>))</span></code></pre></div>
<p>To validate your threshold classification, you can make frequency distribution plots for each of the three features for <em>a priori</em> categories ‘good’, ‘bad’, and ‘unassigned’. Note, zoom into x axes by yourself for better visibility.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="falsePositives.html#cb227-1"></a><span class="co"># some diagnostic plots</span></span>
<span id="cb227-2"><a href="falsePositives.html#cb227-2"></a>plotdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;runLen&quot;</span>, <span class="st">&quot;propMiss&quot;</span>, <span class="st">&quot;deltaMeanBI&quot;</span>),</span>
<span id="cb227-3"><a href="falsePositives.html#cb227-3"></a>                                   <span class="dt">each =</span> <span class="kw">nrow</span>(runFeat)),</span>
<span id="cb227-4"><a href="falsePositives.html#cb227-4"></a>                       <span class="dt">value =</span> <span class="kw">c</span>(runFeat<span class="op">$</span>runLen, runFeat<span class="op">$</span>propMiss, runFeat<span class="op">$</span>deltaMeanBI),</span>
<span id="cb227-5"><a href="falsePositives.html#cb227-5"></a>                       <span class="dt">category =</span> <span class="kw">c</span>(<span class="kw">rep</span>(runFeat<span class="op">$</span>category, <span class="dv">3</span>)),</span>
<span id="cb227-6"><a href="falsePositives.html#cb227-6"></a>                       <span class="dt">stringsAsFactors =</span> F) <span class="co">#%&gt;%</span></span>
<span id="cb227-7"><a href="falsePositives.html#cb227-7"></a>  <span class="co">#filter(category != &quot;unassigned&quot;) # uncomment the %&gt;% filter() statement to ignore the &#39;unassigned&#39;</span></span>
<span id="cb227-8"><a href="falsePositives.html#cb227-8"></a></span>
<span id="cb227-9"><a href="falsePositives.html#cb227-9"></a></span>
<span id="cb227-10"><a href="falsePositives.html#cb227-10"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> plotdata, </span>
<span id="cb227-11"><a href="falsePositives.html#cb227-11"></a>             <span class="kw">aes</span>(<span class="kw">abs</span>(value), <span class="dt">group =</span> category, <span class="dt">colour =</span> category)) <span class="op">+</span></span>
<span id="cb227-12"><a href="falsePositives.html#cb227-12"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb227-13"><a href="falsePositives.html#cb227-13"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb227-14"><a href="falsePositives.html#cb227-14"></a></span>
<span id="cb227-15"><a href="falsePositives.html#cb227-15"></a><span class="kw">rm</span>(plotdata)</span>
<span id="cb227-16"><a href="falsePositives.html#cb227-16"></a></span>
<span id="cb227-17"><a href="falsePositives.html#cb227-17"></a>p1</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-29-1.png" width="1152" /></p>
</div>
<div id="step-2-identification-of-potential-diagnostic-parameters" class="section level2">
<h2><span class="header-section-number">9.3</span> Step 2 – Identification of potential diagnostic parameters</h2>
<p>The Motus <code>alltags</code> table provides some physical parameters, such as <code>sigsd</code>, <code>noise</code>, <code>freqsd</code>, <code>slop</code>, <code>burstSlop</code> (see Appendix <a href="appendixA.html#appendixA">A</a> for detailed explanation of variables). We can calculate the mean values of each parameter for each run and check graphically if it can be used to describe the quality of the recorded run.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="falsePositives.html#cb228-1"></a><span class="co">##### Step 2 - Identification of potential diagnostic parameters</span></span>
<span id="cb228-2"><a href="falsePositives.html#cb228-2"></a></span>
<span id="cb228-3"><a href="falsePositives.html#cb228-3"></a><span class="co">### calculate run mean values for</span></span>
<span id="cb228-4"><a href="falsePositives.html#cb228-4"></a><span class="co">#   &#39;sigsd&#39;, &#39;noise&#39;, &#39;freqsd&#39;, &#39;slop&#39;, &#39;burstSlop&#39;</span></span>
<span id="cb228-5"><a href="falsePositives.html#cb228-5"></a>runTemp &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb228-6"><a href="falsePositives.html#cb228-6"></a><span class="st">  </span><span class="kw">group_by</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb228-7"><a href="falsePositives.html#cb228-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">meanTs =</span> <span class="kw">mean</span>(ts),</span>
<span id="cb228-8"><a href="falsePositives.html#cb228-8"></a>         <span class="dt">meanSigSD =</span> <span class="kw">mean</span>(sigsd),</span>
<span id="cb228-9"><a href="falsePositives.html#cb228-9"></a>         <span class="dt">meanNoise =</span> <span class="kw">mean</span>(noise),</span>
<span id="cb228-10"><a href="falsePositives.html#cb228-10"></a>         <span class="dt">meanFreqSD =</span> <span class="kw">mean</span>(freqsd),</span>
<span id="cb228-11"><a href="falsePositives.html#cb228-11"></a>         <span class="dt">meanSlop =</span> <span class="kw">mean</span>(slop),</span>
<span id="cb228-12"><a href="falsePositives.html#cb228-12"></a>         <span class="dt">meanBurstSlop =</span> <span class="kw">mean</span>(burstSlop)) <span class="op">%&gt;%</span></span>
<span id="cb228-13"><a href="falsePositives.html#cb228-13"></a><span class="st">  </span><span class="kw">select</span>(runID, meanTs, meanSigSD, meanNoise, meanFreqSD, meanSlop, meanBurstSlop) <span class="op">%&gt;%</span></span>
<span id="cb228-14"><a href="falsePositives.html#cb228-14"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">duplicated</span>(runID)<span class="op">==</span>F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb228-15"><a href="falsePositives.html#cb228-15"></a><span class="st">  </span><span class="kw">ungroup</span>()</span>
<span id="cb228-16"><a href="falsePositives.html#cb228-16"></a></span>
<span id="cb228-17"><a href="falsePositives.html#cb228-17"></a>runFeat &lt;-<span class="st"> </span><span class="kw">merge</span>(runFeat, runTemp, <span class="dt">by =</span> <span class="st">&quot;runID&quot;</span>)</span>
<span id="cb228-18"><a href="falsePositives.html#cb228-18"></a></span>
<span id="cb228-19"><a href="falsePositives.html#cb228-19"></a><span class="kw">rm</span>(runTemp)</span>
<span id="cb228-20"><a href="falsePositives.html#cb228-20"></a></span>
<span id="cb228-21"><a href="falsePositives.html#cb228-21"></a><span class="co"># plot variables (visual inspection of informative content)</span></span>
<span id="cb228-22"><a href="falsePositives.html#cb228-22"></a>plotdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;meanSigSD&quot;</span>, <span class="st">&quot;meanNoise&quot;</span>, <span class="st">&quot;meanFreqSD&quot;</span>,</span>
<span id="cb228-23"><a href="falsePositives.html#cb228-23"></a>                                     <span class="st">&quot;meanSlop&quot;</span>, <span class="st">&quot;meanBurstSlop&quot;</span>),</span>
<span id="cb228-24"><a href="falsePositives.html#cb228-24"></a>                                   <span class="dt">each =</span> <span class="kw">nrow</span>(runFeat)),</span>
<span id="cb228-25"><a href="falsePositives.html#cb228-25"></a>                       <span class="dt">value =</span> <span class="kw">c</span>(runFeat<span class="op">$</span>meanSigSD, runFeat<span class="op">$</span>meanNoise,</span>
<span id="cb228-26"><a href="falsePositives.html#cb228-26"></a>                                 runFeat<span class="op">$</span>meanFreqSD, runFeat<span class="op">$</span>meanSlop,</span>
<span id="cb228-27"><a href="falsePositives.html#cb228-27"></a>                                 runFeat<span class="op">$</span>meanBurstSlop),</span>
<span id="cb228-28"><a href="falsePositives.html#cb228-28"></a>                       <span class="dt">category =</span> <span class="kw">c</span>(<span class="kw">rep</span>(runFeat<span class="op">$</span>category, <span class="dv">5</span>)),</span>
<span id="cb228-29"><a href="falsePositives.html#cb228-29"></a>                       <span class="dt">stringsAsFactors =</span> F) <span class="co">#%&gt;%</span></span>
<span id="cb228-30"><a href="falsePositives.html#cb228-30"></a>  <span class="co">#filter(category != &quot;unassigned&quot;) # uncomment the %&gt;% filter() statement to ignore the &#39;unassigned&#39;</span></span>
<span id="cb228-31"><a href="falsePositives.html#cb228-31"></a></span>
<span id="cb228-32"><a href="falsePositives.html#cb228-32"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> plotdata, </span>
<span id="cb228-33"><a href="falsePositives.html#cb228-33"></a>             <span class="kw">aes</span>(<span class="kw">abs</span>(value), <span class="dt">group =</span> category, <span class="dt">colour =</span> category)) <span class="op">+</span></span>
<span id="cb228-34"><a href="falsePositives.html#cb228-34"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb228-35"><a href="falsePositives.html#cb228-35"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb228-36"><a href="falsePositives.html#cb228-36"></a></span>
<span id="cb228-37"><a href="falsePositives.html#cb228-37"></a><span class="kw">rm</span>(plotdata)</span>
<span id="cb228-38"><a href="falsePositives.html#cb228-38"></a></span>
<span id="cb228-39"><a href="falsePositives.html#cb228-39"></a>p2</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-30-1.png" width="1152" /></p>
<p>There are, of course, other factors that can help to validate the detection. We want to pick two of them, noisiness and continuity, and create additional variables to describe these factors. Noisiness is quite difficult to characterize, but it can be stated that at times with many recordings at a given receiver, there is a lot of noise. We can use the <code>activity</code> table to identify the number of runs and their lengths for each antenna of each receiver recorded per hour. We can get a more complete picture of noisiness using the <code>activity</code> table because it includes numbers of runs across all projects, not just our own. We can also calculate ‘proportion of short run lengths in runs per receiver hour’ and link the data from the <code>activity</code> table back to the runs in the <code>alltags</code> table via the <code>runs</code> table by calculating the <code>hourBin</code> for each <code>runID</code>. This allows us to connect the information on noise in the <code>activity</code> table back to our detection data. In addition, there might be a propensity for some tags to be recorded with short run lengths, i.e. detections resulting from noise. We can therefore calculate for each tag a variable for the overall ‘proportion of short run lengths’.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="falsePositives.html#cb229-1"></a><span class="co"># get activity table</span></span>
<span id="cb229-2"><a href="falsePositives.html#cb229-2"></a>a &lt;-<span class="st"> </span><span class="kw">tbl</span>(db, <span class="st">&quot;activity&quot;</span>)</span>
<span id="cb229-3"><a href="falsePositives.html#cb229-3"></a></span>
<span id="cb229-4"><a href="falsePositives.html#cb229-4"></a>adf &lt;-<span class="st"> </span>a <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-5"><a href="falsePositives.html#cb229-5"></a><span class="st">  </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame                                 <span class="co"># convert into flat data frame</span></span>
<span id="cb229-6"><a href="falsePositives.html#cb229-6"></a>  </span>
<span id="cb229-7"><a href="falsePositives.html#cb229-7"></a><span class="kw">rm</span>(a)</span>
<span id="cb229-8"><a href="falsePositives.html#cb229-8"></a></span>
<span id="cb229-9"><a href="falsePositives.html#cb229-9"></a><span class="co"># get runs table</span></span>
<span id="cb229-10"><a href="falsePositives.html#cb229-10"></a>r &lt;-<span class="st"> </span><span class="kw">tbl</span>(db, <span class="st">&quot;runs&quot;</span>)</span>
<span id="cb229-11"><a href="falsePositives.html#cb229-11"></a></span>
<span id="cb229-12"><a href="falsePositives.html#cb229-12"></a>rdf &lt;-<span class="st"> </span>r <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-13"><a href="falsePositives.html#cb229-13"></a><span class="st">  </span>collect <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-14"><a href="falsePositives.html#cb229-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hourBin =</span> <span class="kw">floor</span>(tsBegin<span class="op">/</span><span class="dv">3600</span>))                     <span class="co"># calculate hourBin for each run</span></span>
<span id="cb229-15"><a href="falsePositives.html#cb229-15"></a></span>
<span id="cb229-16"><a href="falsePositives.html#cb229-16"></a><span class="kw">rm</span>(r)</span>
<span id="cb229-17"><a href="falsePositives.html#cb229-17"></a></span>
<span id="cb229-18"><a href="falsePositives.html#cb229-18"></a><span class="co"># join runs and activity tables to get hourly values on runs/recv for each runID</span></span>
<span id="cb229-19"><a href="falsePositives.html#cb229-19"></a>radf &lt;-<span class="st"> </span><span class="kw">left_join</span>(rdf, adf, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;batchIDbegin&quot;</span> =<span class="st"> &quot;batchID&quot;</span>, <span class="st">&quot;ant&quot;</span>, <span class="st">&quot;hourBin&quot;</span>))</span>
<span id="cb229-20"><a href="falsePositives.html#cb229-20"></a></span>
<span id="cb229-21"><a href="falsePositives.html#cb229-21"></a><span class="co"># join with detection data</span></span>
<span id="cb229-22"><a href="falsePositives.html#cb229-22"></a>df &lt;-<span class="st"> </span><span class="kw">left_join</span>(df, radf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(runID, numRuns, numHits, run2, run3), <span class="dt">by =</span> <span class="st">&quot;runID&quot;</span>)</span>
<span id="cb229-23"><a href="falsePositives.html#cb229-23"></a></span>
<span id="cb229-24"><a href="falsePositives.html#cb229-24"></a><span class="co">### calculate &#39;noise&#39; variables with values from activity table</span></span>
<span id="cb229-25"><a href="falsePositives.html#cb229-25"></a>runTemp &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-26"><a href="falsePositives.html#cb229-26"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">propRS =</span> (run2 <span class="op">+</span><span class="st"> </span>run3)<span class="op">/</span>numRuns) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of short runs per receiver hour</span></span>
<span id="cb229-27"><a href="falsePositives.html#cb229-27"></a><span class="st">  </span><span class="kw">group_by</span>(motusTagID) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-28"><a href="falsePositives.html#cb229-28"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">tagPropRS =</span> <span class="kw">length</span>(<span class="kw">unique</span>(runID[runLen<span class="op">&lt;</span><span class="dv">4</span>]))<span class="op">/</span><span class="kw">length</span>(<span class="kw">unique</span>(runID))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># tags’ proportion of short runs</span></span>
<span id="cb229-29"><a href="falsePositives.html#cb229-29"></a><span class="st">  </span><span class="kw">group_by</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb229-30"><a href="falsePositives.html#cb229-30"></a><span class="st">  </span><span class="kw">select</span>(runID, numRuns, propRS, tagPropRS) <span class="op">%&gt;%</span></span>
<span id="cb229-31"><a href="falsePositives.html#cb229-31"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">duplicated</span>(runID)<span class="op">==</span>F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb229-32"><a href="falsePositives.html#cb229-32"></a><span class="st">  </span><span class="kw">ungroup</span>()</span>
<span id="cb229-33"><a href="falsePositives.html#cb229-33"></a></span>
<span id="cb229-34"><a href="falsePositives.html#cb229-34"></a>runFeat &lt;-<span class="st"> </span><span class="kw">merge</span>(runFeat, runTemp, <span class="dt">by =</span> <span class="st">&quot;runID&quot;</span>)</span>
<span id="cb229-35"><a href="falsePositives.html#cb229-35"></a></span>
<span id="cb229-36"><a href="falsePositives.html#cb229-36"></a><span class="kw">rm</span>(runTemp)</span>
<span id="cb229-37"><a href="falsePositives.html#cb229-37"></a></span>
<span id="cb229-38"><a href="falsePositives.html#cb229-38"></a><span class="co"># plot variables</span></span>
<span id="cb229-39"><a href="falsePositives.html#cb229-39"></a>plotdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;numRuns&quot;</span>, <span class="st">&quot;propRS&quot;</span>, <span class="st">&quot;tagPropRS&quot;</span>),</span>
<span id="cb229-40"><a href="falsePositives.html#cb229-40"></a>                                   <span class="dt">each =</span> <span class="kw">nrow</span>(runFeat)),</span>
<span id="cb229-41"><a href="falsePositives.html#cb229-41"></a>                       <span class="dt">value =</span> <span class="kw">c</span>(runFeat<span class="op">$</span>numRuns, runFeat<span class="op">$</span>propRS, runFeat<span class="op">$</span>tagPropRS),</span>
<span id="cb229-42"><a href="falsePositives.html#cb229-42"></a>                       <span class="dt">category =</span> <span class="kw">c</span>(<span class="kw">rep</span>(runFeat<span class="op">$</span>category, <span class="dv">3</span>)), <span class="dt">stringsAsFactors =</span> F) <span class="co">#%&gt;%</span></span>
<span id="cb229-43"><a href="falsePositives.html#cb229-43"></a>  <span class="co">#filter(category != &quot;unassigned&quot;) # uncomment the %&gt;% filter() statement to ignore the ‘unassigned’</span></span>
<span id="cb229-44"><a href="falsePositives.html#cb229-44"></a></span>
<span id="cb229-45"><a href="falsePositives.html#cb229-45"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> plotdata, <span class="kw">aes</span>(<span class="kw">abs</span>(value), <span class="dt">group =</span> category, <span class="dt">colour =</span> category)) <span class="op">+</span></span>
<span id="cb229-46"><a href="falsePositives.html#cb229-46"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb229-47"><a href="falsePositives.html#cb229-47"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb229-48"><a href="falsePositives.html#cb229-48"></a></span>
<span id="cb229-49"><a href="falsePositives.html#cb229-49"></a><span class="kw">rm</span>(plotdata)</span>
<span id="cb229-50"><a href="falsePositives.html#cb229-50"></a></span>
<span id="cb229-51"><a href="falsePositives.html#cb229-51"></a>p3</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-31-1.png" width="1152" /></p>
<p>The other factor that might bear some importance and potential for diagnostics is continuity. This means that recordings assigned to match a certain tag may be more trustworthy if other recordings assigned to the same tag happen in some time window at the same or another antenna of the same receiver station. We thus calculate the number of runs and the number of recording antenna ports assigned to the same tag within 25 minutes of the mean time stamp of the given run.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="falsePositives.html#cb230-1"></a><span class="co">### calculate &#39;continuity&#39; variables</span></span>
<span id="cb230-2"><a href="falsePositives.html#cb230-2"></a>runTemp &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb230-3"><a href="falsePositives.html#cb230-3"></a><span class="st">  </span><span class="kw">group_by</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb230-4"><a href="falsePositives.html#cb230-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">meanTs =</span> <span class="kw">mean</span>(ts)) <span class="op">%&gt;%</span></span>
<span id="cb230-5"><a href="falsePositives.html#cb230-5"></a><span class="st">  </span><span class="kw">group_by</span>(motusTagID, recv) <span class="op">%&gt;%</span></span>
<span id="cb230-6"><a href="falsePositives.html#cb230-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nContRuns =</span> <span class="kw">length</span>(<span class="kw">unique</span>(runID[ts <span class="op">&lt;=</span><span class="st"> </span>meanTs <span class="op">+</span><span class="st"> </span><span class="dv">25</span><span class="op">*</span><span class="dv">60</span> <span class="op">|</span></span>
<span id="cb230-7"><a href="falsePositives.html#cb230-7"></a><span class="st">                                         </span>ts <span class="op">&gt;=</span><span class="st"> </span>meanTs <span class="op">-</span><span class="st"> </span><span class="dv">25</span><span class="op">*</span><span class="dv">60</span>])),</span>
<span id="cb230-8"><a href="falsePositives.html#cb230-8"></a>         <span class="dt">nPorts =</span> <span class="kw">length</span>(<span class="kw">unique</span>(port[ts <span class="op">&lt;=</span><span class="st"> </span>meanTs <span class="op">+</span><span class="st"> </span><span class="dv">25</span><span class="op">*</span><span class="dv">60</span> <span class="op">|</span></span>
<span id="cb230-9"><a href="falsePositives.html#cb230-9"></a><span class="st">                                     </span>ts <span class="op">&gt;=</span><span class="st"> </span>meanTs <span class="op">-</span><span class="st"> </span><span class="dv">25</span><span class="op">*</span><span class="dv">60</span>]))) <span class="op">%&gt;%</span></span>
<span id="cb230-10"><a href="falsePositives.html#cb230-10"></a><span class="st">  </span><span class="kw">group_by</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb230-11"><a href="falsePositives.html#cb230-11"></a><span class="st">  </span><span class="kw">select</span>(runID, nContRuns, nPorts) <span class="op">%&gt;%</span></span>
<span id="cb230-12"><a href="falsePositives.html#cb230-12"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">duplicated</span>(runID)<span class="op">==</span>F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb230-13"><a href="falsePositives.html#cb230-13"></a><span class="st">  </span><span class="kw">ungroup</span>()</span>
<span id="cb230-14"><a href="falsePositives.html#cb230-14"></a></span>
<span id="cb230-15"><a href="falsePositives.html#cb230-15"></a>runFeat &lt;-<span class="st"> </span><span class="kw">merge</span>(runFeat, runTemp, <span class="dt">by =</span> <span class="st">&quot;runID&quot;</span>)</span>
<span id="cb230-16"><a href="falsePositives.html#cb230-16"></a></span>
<span id="cb230-17"><a href="falsePositives.html#cb230-17"></a><span class="kw">rm</span>(runTemp)</span></code></pre></div>
<p>We can check the importance of these new variables graphically again.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="falsePositives.html#cb231-1"></a><span class="co"># plot variables</span></span>
<span id="cb231-2"><a href="falsePositives.html#cb231-2"></a>plotdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;nContRuns&quot;</span>, <span class="st">&quot;nPorts&quot;</span>),</span>
<span id="cb231-3"><a href="falsePositives.html#cb231-3"></a>                                   <span class="dt">each =</span> <span class="kw">nrow</span>(runFeat)),</span>
<span id="cb231-4"><a href="falsePositives.html#cb231-4"></a>                       <span class="dt">value =</span> <span class="kw">c</span>(runFeat<span class="op">$</span>nContRuns, runFeat<span class="op">$</span>nPorts),</span>
<span id="cb231-5"><a href="falsePositives.html#cb231-5"></a>                       <span class="dt">category =</span> <span class="kw">c</span>(<span class="kw">rep</span>(runFeat<span class="op">$</span>category, <span class="dv">2</span>)),</span>
<span id="cb231-6"><a href="falsePositives.html#cb231-6"></a>                       <span class="dt">stringsAsFactors =</span> F) <span class="co">#%&gt;%</span></span>
<span id="cb231-7"><a href="falsePositives.html#cb231-7"></a>  <span class="co">#filter(category != &quot;unassigned&quot;) # uncomment the %&gt;% filter() statement to ignore the &#39;unassigned&#39;</span></span>
<span id="cb231-8"><a href="falsePositives.html#cb231-8"></a></span>
<span id="cb231-9"><a href="falsePositives.html#cb231-9"></a></span>
<span id="cb231-10"><a href="falsePositives.html#cb231-10"></a>p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> plotdata, </span>
<span id="cb231-11"><a href="falsePositives.html#cb231-11"></a>             <span class="kw">aes</span>(<span class="kw">abs</span>(value), <span class="dt">group =</span> category, <span class="dt">colour =</span> category)) <span class="op">+</span></span>
<span id="cb231-12"><a href="falsePositives.html#cb231-12"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb231-13"><a href="falsePositives.html#cb231-13"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>group, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb231-14"><a href="falsePositives.html#cb231-14"></a></span>
<span id="cb231-15"><a href="falsePositives.html#cb231-15"></a><span class="kw">rm</span>(plotdata)</span>
<span id="cb231-16"><a href="falsePositives.html#cb231-16"></a></span>
<span id="cb231-17"><a href="falsePositives.html#cb231-17"></a>p4</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-33-1.png" width="1152" /></p>
</div>
<div id="step-3-prediction-of-the-probability-of-being-a-false-positive" class="section level2">
<h2><span class="header-section-number">9.4</span> Step 3 – Prediction of the probability of being a false positive</h2>
<p>From the plots produced above, we can examine which variables we would like to include in our logistic regression model to predict the probability of a given run being a false positive. An additional factor we might use is tag model. Depending on the antenna of the tag, the specified burst intervals or the transmitted power of the tag, different tag types might bear different detection probabilities and consequently, different probabilities of resulting in false detections. This only makes sense, however, if different tag types are used, or if different tag properties were assigned to different tag types. To better match these to your data, you can use the date-bin of tag registration or create your own variable.</p>
<p>The modelling approach is quite simple: first, confine your created dataset to data for either category ‘good’ or ‘bad’ and transform the category into a binary variable. Make sure you have assigned ‘1’ to ‘bad’ and ‘0’ to ‘good’ in order to predict the probability of being a ‘bad’ detection! Note the ‘unassigned’ category is ignored here as we now want to predict the probabilities for these data. Second, run a binomial generalized linear model over the variables you have selected based on the diagnostic plots you have made before and store the results into another variable. You can also calculate some goodness of fit parameters to check the predictive power of your model fit. Finally, you can use the stored model outcome to predict the estimated probability of being a false positive for all runs in your detection data. Note that our example model includes all variables mentioned above, but we recommend you to carefully select powerful variables that might best represent the characteristics of your own data. You may also want to explore other potential variables that we do not include in this example.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="falsePositives.html#cb232-1"></a><span class="co">##### Step 3 - Prediction of the probability of being a false positive</span></span>
<span id="cb232-2"><a href="falsePositives.html#cb232-2"></a></span>
<span id="cb232-3"><a href="falsePositives.html#cb232-3"></a>modeldata &lt;-<span class="st"> </span>runFeat <span class="op">%&gt;%</span></span>
<span id="cb232-4"><a href="falsePositives.html#cb232-4"></a><span class="st">  </span><span class="kw">filter</span>(category <span class="op">!=</span><span class="st"> &quot;unassigned&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb232-5"><a href="falsePositives.html#cb232-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">category =</span> <span class="kw">as.numeric</span>(<span class="kw">ifelse</span>(category <span class="op">==</span><span class="st"> &quot;good&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb232-6"><a href="falsePositives.html#cb232-6"></a>  </span>
<span id="cb232-7"><a href="falsePositives.html#cb232-7"></a></span>
<span id="cb232-8"><a href="falsePositives.html#cb232-8"></a><span class="co"># basic model</span></span>
<span id="cb232-9"><a href="falsePositives.html#cb232-9"></a>M &lt;-<span class="st"> </span><span class="kw">glm</span>(category <span class="op">~</span><span class="st"> </span>meanSigSD <span class="op">+</span><span class="st"> </span>meanNoise <span class="op">+</span><span class="st"> </span>meanFreqSD <span class="op">+</span><span class="st"> </span>meanSlop <span class="op">+</span><span class="st"> </span>meanBurstSlop <span class="op">+</span></span>
<span id="cb232-10"><a href="falsePositives.html#cb232-10"></a><span class="st">         </span>numRuns <span class="op">+</span><span class="st"> </span>propRS <span class="op">+</span><span class="st"> </span>tagPropRS <span class="op">+</span><span class="st"> </span>nContRuns <span class="op">+</span><span class="st"> </span>nPorts,</span>
<span id="cb232-11"><a href="falsePositives.html#cb232-11"></a>         <span class="dt">data =</span> modeldata, <span class="dt">family =</span> <span class="kw">binomial</span>())</span>
<span id="cb232-12"><a href="falsePositives.html#cb232-12"></a></span>
<span id="cb232-13"><a href="falsePositives.html#cb232-13"></a><span class="kw">summary</span>(M)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = category ~ meanSigSD + meanNoise + meanFreqSD + 
##     meanSlop + meanBurstSlop + numRuns + propRS + tagPropRS + 
##     nContRuns + nPorts, family = binomial(), data = modeldata)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.67085  -0.89046   0.02365   0.94677   2.28095  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -5.248e+00  8.463e-01  -6.202 5.59e-10 ***
## meanSigSD     -6.627e-03  3.306e-03  -2.005  0.04500 *  
## meanNoise     -4.412e-02  9.099e-03  -4.849 1.24e-06 ***
## meanFreqSD     6.430e+00  2.117e+00   3.037  0.00239 ** 
## meanSlop       8.265e+02  1.525e+02   5.419 5.98e-08 ***
## meanBurstSlop -6.526e+01  3.130e+01  -2.085  0.03704 *  
## numRuns        4.883e-04  3.595e-04   1.358  0.17433    
## propRS         3.702e+00  2.169e-01  17.065  &lt; 2e-16 ***
## tagPropRS      1.494e+00  5.009e-01   2.983  0.00286 ** 
## nContRuns      7.711e-04  1.396e-04   5.523 3.32e-08 ***
## nPorts        -2.552e-01  9.593e-02  -2.661  0.00780 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4253.4  on 3112  degrees of freedom
## Residual deviance: 3013.1  on 3102  degrees of freedom
##   (4 observations deleted due to missingness)
## AIC: 3035.1
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="falsePositives.html#cb234-1"></a><span class="co"># goodness of fit parameters</span></span>
<span id="cb234-2"><a href="falsePositives.html#cb234-2"></a>MRS &lt;-<span class="st"> </span><span class="kw">lrm</span>(category <span class="op">~</span><span class="st"> </span>meanSigSD <span class="op">+</span><span class="st"> </span>meanNoise <span class="op">+</span><span class="st"> </span>meanFreqSD <span class="op">+</span><span class="st"> </span>meanSlop <span class="op">+</span><span class="st"> </span>meanBurstSlop <span class="op">+</span></span>
<span id="cb234-3"><a href="falsePositives.html#cb234-3"></a><span class="st">           </span>numRuns <span class="op">+</span><span class="st"> </span>propRS <span class="op">+</span><span class="st"> </span>tagPropRS <span class="op">+</span><span class="st"> </span>nContRuns <span class="op">+</span><span class="st"> </span>nPorts,</span>
<span id="cb234-4"><a href="falsePositives.html#cb234-4"></a>           <span class="dt">data =</span> modeldata)</span>
<span id="cb234-5"><a href="falsePositives.html#cb234-5"></a></span>
<span id="cb234-6"><a href="falsePositives.html#cb234-6"></a>MRS<span class="op">$</span>stats[<span class="dv">10</span>] <span class="co"># Nagelkerke&#39;s pseudo R^2</span></span></code></pre></div>
<pre><code>##        R2 
## 0.4411341</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="falsePositives.html#cb236-1"></a><span class="kw">rm</span>(modeldata)</span>
<span id="cb236-2"><a href="falsePositives.html#cb236-2"></a></span>
<span id="cb236-3"><a href="falsePositives.html#cb236-3"></a><span class="co"># predict probability of being a &#39;bad&#39; run</span></span>
<span id="cb236-4"><a href="falsePositives.html#cb236-4"></a>runFeat<span class="op">$</span>probBad &lt;-<span class="st"> </span><span class="kw">predict</span>(M, runFeat, <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>You can now plot the probability for each of the categories you have defined in step 1 to visually check the validity of your predictions. Ideally, runs of the category ‘good’ should have resulted in low probability estimates, whereas runs of the category ‘bad’ should have resulted in high probability estimates. There should, however, also be some overlap meaning there should be some runs previously assigned as bad with low probability estimates. Nevertheless, the two ‘good’ and ‘bad’ curves should be clearly separated.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="falsePositives.html#cb237-1"></a><span class="co"># plot predicted values (graphical inspection of goodness of fit)</span></span>
<span id="cb237-2"><a href="falsePositives.html#cb237-2"></a>p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> runFeat, <span class="kw">aes</span>(probBad, <span class="dt">group =</span> category, <span class="dt">colour =</span> category)) <span class="op">+</span></span>
<span id="cb237-3"><a href="falsePositives.html#cb237-3"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;estimate of probability of being a &#39;bad&#39; run&quot;</span>)</span>
<span id="cb237-4"><a href="falsePositives.html#cb237-4"></a></span>
<span id="cb237-5"><a href="falsePositives.html#cb237-5"></a>p5</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-35-1.png" width="1152" /></p>
<p>You could also use this graph to define your own threshold probability to filter false positives from your data. Make sure not to filter single detections (i.e. by <code>hitID</code>), but to exclude all detections within a run that match your filter criterion for your dataset, i.e. to filter by <code>runID</code>. We generally recommend that afterward you use the tools described in section <a href="dataCleaning.html#assessTagDetections">5.3</a> to check individually if a detection or run you have excluded by your individual threshold settings may still be valid in a biological sense, or if additional detections should be excluded.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="falsePositives.html#cb238-1"></a><span class="co">### set individual threshold and filter detection data by run</span></span>
<span id="cb238-2"><a href="falsePositives.html#cb238-2"></a><span class="co"># find runIDs with probBad &lt; 0.8</span></span>
<span id="cb238-3"><a href="falsePositives.html#cb238-3"></a>runsKeep &lt;-<span class="st"> </span>runFeat <span class="op">%&gt;%</span></span>
<span id="cb238-4"><a href="falsePositives.html#cb238-4"></a><span class="st">  </span><span class="kw">filter</span>(probBad <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.8</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">duplicated</span>(runID)<span class="op">==</span>F) <span class="op">%&gt;%</span></span>
<span id="cb238-5"><a href="falsePositives.html#cb238-5"></a><span class="st">  </span><span class="kw">select</span>(runID) <span class="op">%&gt;%</span></span>
<span id="cb238-6"><a href="falsePositives.html#cb238-6"></a><span class="st">  </span><span class="kw">pull</span>() </span>
<span id="cb238-7"><a href="falsePositives.html#cb238-7"></a></span>
<span id="cb238-8"><a href="falsePositives.html#cb238-8"></a><span class="co"># filter detection data</span></span>
<span id="cb238-9"><a href="falsePositives.html#cb238-9"></a>df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></span>
<span id="cb238-10"><a href="falsePositives.html#cb238-10"></a><span class="st">  </span><span class="kw">filter</span>(runID <span class="op">%in%</span><span class="st"> </span>runsKeep)</span>
<span id="cb238-11"><a href="falsePositives.html#cb238-11"></a></span>
<span id="cb238-12"><a href="falsePositives.html#cb238-12"></a><span class="kw">rm</span>(runsKeep)</span>
<span id="cb238-13"><a href="falsePositives.html#cb238-13"></a></span>
<span id="cb238-14"><a href="falsePositives.html#cb238-14"></a><span class="co"># add threshold to plot of predicted values</span></span>
<span id="cb238-15"><a href="falsePositives.html#cb238-15"></a>p5 <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="MotusRBook_files/figure-html/unnamed-chunk-36-1.png" width="1152" /></p>
<p><strong>Note:</strong> We used the three characteristics <code>runLen</code>, <code>propMiss</code>, and <code>deltaMeanBI</code> when assigning the <em>a priori</em> classification of detections for the sample dataset (project 176), but these characteristics may not be as appropriate for other datasets. There are, of course, other features of false positives and you are invited to create your own set of characteristics for your data. We highly recommend you examine your own data carefully and think critically about how you classify your detection data. This tool is designed to help you detect false positives and speed processing of large datasets, but it is not a one-size-fits-all solution—a careful examination of your dataset and carefully considered selection of classification criteria and predictor variables is absolutely necessary. For example, you might consider classifying ‘bad’ detections as those where over 85% of detections per hour are short runs or where a receiver records more than 100 runs per hour (i.e. a noisy site—similar to how the <code>motusFilter</code> and the <code>filterByActivity</code> function work), and good detections as those where fewer than 50% of detections per hour are short runs. In this case you would be using some of the ‘noise’ variables calculated below as classification features, so you must exclude them as predictor variables. Instead, you could consider some of the features we used in this example to classify the detections (<code>runLen</code>, <code>propMiss</code>, and <code>meanDeltaBI</code>), as potential predictor variables.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="advancedModelling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendixA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MotusRBook.pdf"],
"toc": {
"collapse": "section"
},
"search": true
});
});
</script>

</body>

</html>
